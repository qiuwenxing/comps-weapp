let animationShade=null,animationBody=null,initValue=null;Component({externalClasses:["i-class"],properties:{regionList:{type:Array,value:[],observer(t){this.init(),this.setValue(initValue)}},value:{type:Array,value:[],observer(t){t&&2==t.length&&(0<this.data.regionList.length?this.setValue(t):initValue=t)}},containsAll:{type:Boolean,value:!1}},data:{display:!1,regionData:new Map,provinces:[],citys:[],curIndex:[0,0],curValue:[],origin:{},animationDataShade:null,animationDataBody:null,headItem:["所有省份","所有城市"],isAnimation:!1},methods:{init(){let{regionList:t,containsAll:a,headItem:i,regionData:e,provinces:n,curValue:s}=this.data;0<t.length&&(e=new Map,a&&e.set(i[0],{name:i[0],children:[]}),t.forEach(t=>{e.set(t.name,t)}),0<t.length&&e.forEach((t,a)=>{n.push(a)}),0==s.length&&(s[0]=n[0]),this.setData({regionData:e,provinces:n,curValue:s}),this.refreshCity())},onChange({detail:t}){var t=t.value,{curValue:a,provinces:i,curIndex:e}=this.data;a[0]=i[t[0]],t[0]!=e[0]&&(this.refreshCity(),t[1]=0),a[1]=this.data.citys?this.data.citys[t[1]]:null,this.getVal(),this.setData({curValue:a})},confirm(){var t=this.data["curValue"],a=(this.setData({origin:null}),this.hide(),this.getVal());this.triggerEvent("change",{values:a,names:t})},setValue(a){if(a&&2==a.length){let t=!1;var i=this.data["curValue"];i[0]!=a[0]&&(t=!0),this.setData({curValue:a}),t&&this.refreshCity(!1),this.confirm()}},hide(){let{isAnimation:t,origin:a,curValue:i,curIndex:e,citys:n,display:s}=this.data;var r,l;s&&!t&&(a&&(i=a.curValue,e=a.curIndex,n=a.citys),r=animationShade.opacity(0).step().export(),l=animationBody.translateY("100%").step().export(),this.setData({isAnimation:!0,curValue:i,curIndex:e,citys:n,animationDataShade:r,animationDataBody:l}),setTimeout(()=>{this.setData({display:!1})},400),setTimeout(()=>{this.setData({isAnimation:!1})},500))},show(){var{isAnimation:t,curValue:e,curIndex:n,citys:s,display:a}=this.data;if(!a&&!t){let t={curValue:e,curIndex:n,citys:s},a=animationShade.opacity(1).step().export(),i=animationBody.translateY("0").step().export();this.setData({isAnimation:!0,display:!0}),setTimeout(()=>{this.setData({origin:t,animationDataShade:a,animationDataBody:i})},100),setTimeout(()=>{this.setData({isAnimation:!1})},500)}},refreshCity(t=!0){var{curValue:a,citys:i,headItem:e,containsAll:n}=this.data;0<a.length&&(i=this.getCitys(a[0])||[],n&&i&&i.unshift(e[1]),0<i.length&&t&&(a[1]=i[0]),this.setData({citys:i,curValue:a}))},getCitys(t){var i=this.data["regionData"],i=i.get(t);if(i&&i.children){let a=[];return i.children.forEach(t=>{a.push(t.name)}),a}return null},getVal(){let t=0,a=0,{curValue:i,provinces:e,citys:n,curIndex:s}=this.data;return 0<e.length&&(0<i.length&&(t=e.indexOf(i[0]),1<i.length)&&n&&(a=n.indexOf(i[1])),s=[t,a],this.setData({curIndex:s})),s},noTouch(){},onPickStart(){},onPickEnd(){}},created(){animationShade=wx.createAnimation({duration:500,timingFunction:"ease",transformOrigin:"50% 50%"}),animationBody=wx.createAnimation({duration:300,timingFunction:"ease",transformOrigin:"50% 50%"})}});
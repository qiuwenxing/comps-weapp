let arrowAnimation=null;Component({externalClasses:["i-class"],properties:{open:{type:String,value:"all"},noDataText:{type:String,value:"暂无更多内容"},backTopVisible:{type:Boolean,value:!1},backTopImage:{type:String,value:"../assets/images/top-scroll.png"}},data:{refreshCount:0,upInsertDOM:!1,isLockUp:!1,isLockDown:!1,isData:!0,loading:!1,domHeight:0,upStatus:"",downStatus:"",startTime:0,startY:0,scroll:0,distance:80,loadingHeight:40,touchScrollTop:0,moveY:0,direction:"",transitionTime:0,isScroll:!0,arrowAnimationData:null,intoView:"",backTopShow:!1},observers:{"backTopVisible,scroll":function(){var{backTopVisible:t,scroll:a}=this.data;this.setData({backTopShow:t&&300<a})}},methods:{onScroll(t){this.setData({scroll:t.detail.scrollTop}),this.triggerEvent("scroll",t)},startHandle(t){var a;this.data.loading||"down"!=this.data.open&&"all"!=this.data.open||(t=t.touches[0].pageY,a=this.data.scroll,this.setData({startY:t,touchScrollTop:a}))},moveHandle(h){let{loading:t,open:a,direction:c,isScroll:p}=this.data;if(!t&&("down"==a||"all"==a)){let t=h.touches[0].pageY-this.data.startY,{transitionTime:o,touchScrollTop:a,isLockUp:i,domHeight:s,upInsertDOM:e,upStatus:n,distance:l,arrowAnimationData:r,loadingHeight:d}=this.data;0<t?c="down":t<0&&(c="up");var u,h=Math.abs(t);if(a<=0&&"down"==c&&!i){p=!1;let t=0,a=0;e=e||!0,o=0,h<=l?(t=h,n="refresh"):l<h&&h<=2*l?(t=l+.5*(h-l),n="update"):t=l+.5*l+.2*(h-2*l),s=.7*t,d<h&&(h=h-d,u=l-d,a=(u<h?u:h)/u*180),r=arrowAnimation.rotateZ(a).step().export()}else p=!0,s=0,t=0;this.setData({isScroll:p,domHeight:s,moveY:t,direction:c,upInsertDOM:e,upStatus:n,transitionTime:o,arrowAnimationData:r})}},endHandle(t){let{loading:a,open:o,moveY:i,domHeight:s,upStatus:e,transitionTime:n,touchScrollTop:l,direction:r,isLockUp:d,distance:h,loadingHeight:c}=this.data;var p;i=(!(a||"down"!=o&&"all"!=o)&&(p=Math.abs(i),l<=0)&&"down"==r&&!d?(n=300,h<p?(s=c,e="load",this.refresh()):(s=0,setTimeout(()=>{this.setData({upInsertDOM:!1})},300))):s=0,0),this.setData({moveY:i,domHeight:s,upStatus:e,transitionTime:n,isScroll:!0})},pullUp(){this.data.loading||"up"!=this.data.open&&"all"!=this.data.open||this.triggerEvent("pullup")},startLoad(){this.setData({loading:!0,downStatus:"load"})},stopLoad(){"noData"!=this.data.downStatus&&this.setData({loading:!1,downStatus:""})},noData(){this.setData({loading:!1,downStatus:"noData"})},refresh(){var t=this.data.refreshCount+1,a=Date.now();this.setData({refreshCount:t,startTime:a,loading:!0}),this.triggerEvent("pulldown")},stop(){var t=Date.now()-this.data.startTime;t<600?setTimeout(()=>{this.resetload()},600-t):this.resetload()},lock(t){let{isLockDown:a,isLockUp:o}=this.data;switch(t){case"up":o=!0;break;case"down":a=!0;break;default:o=!0,a=!0}this.setData({isLockDown:a,isLockUp:o})},unlock(t){let{isLockDown:a,isLockUp:o}=this.data;switch(t){case"up":o=!1;break;case"down":a=!1;break;default:o=!1,a=!1}this.setData({isLockDown:a,isLockUp:o})},resetload(){let t=this.data["upInsertDOM"];"down"==this.data.direction&&t&&(this.setData({domHeight:0}),setTimeout(()=>{t=!1;this.setData({loading:!1,upInsertDOM:t,isScroll:!0,upStatus:""})},300))},onBackTop(){this.setData({intoView:"scrollTop"})}},created(){arrowAnimation=wx.createAnimation({duration:0,timingFunction:"ease",transformOrigin:"50% 50%"})}});